

###1号店puppet实战

####Puppet的应用场景

####Puppet的案例

####Puppet的架构

1. 默认的puppet server是webrik，速度太慢
2. 走https协议
3. 由统一授权管理端验证权限，然后改为http协议，提高性能
4. 从线上中按照功能采样一部分做测试机，避免重复搭建测试环境

####Puppet权限外放

由于Puppet的安全权限很高，且各企业内部有自己的云平台，于是需要单搞。

**External node classifiers**
外部节点管理器

Facter
系统信息探针

Custom Facter 业务体现
便于定制化实现业务需求，例如购物车tomcat分3/4内存，其他tomcat分1/4内存

**ZABBIX案例**

不同系统安装不同版本&宿主机安装特殊包
不同IDC指向不同server

###乌云众测中的运维漏洞

* 被偷走的代码

在svn中有个隐藏文件夹里面有代码信息
svn: xxx.xxx.com/.svn/entries

* 域名劫持

直接劫持就好了

* 密码重置

利用密码重置功能，发包暴力破解就好了

* 程序员的复仇

由于逻辑是更改文件名，结果被黑客给传值index.php，于是把自己的首页干掉了

###京东运维

方法论：知道 -》 遇到 -》做到 -》 料到

技巧:
* 利用各个IDC来做整体网络的探针，反过来监控某地联通、电信的网络问题，便于及时切换服务
* syslog
机箱中电源坏了几个、端口有up和down抖动
netflow的采样频率是1000/1

整体网路情况（具体到机房内链路）一目了然
IDC公网连通性、质量、影响范围
SYSlog内部网络质量，构成

网络监控结论：
* 相当比例的业务问题不是网咯问题
* 网络最主要的问题是带宽拥塞
* 网络设计陈旧导致网络可靠性差

一个wlan内多少个ip是合适的？一个C

###当当网后台架构

电商搜索做什么

####帮顾客找商品

* 用户意图分析
找什么物品？找什么书？
**基于概率模型的意图分析模型**案例：最近热搜词与物品的关联概率
* 检索系统
倒排索引，正排过滤

保证多样性时，有同类商品聚合
搜葡萄酒，显示第一页30个，有书有酒，书有同名，**如何分页**
wine 1,30
book 1,30

按时间排序，搜索结果多样性如何保证

服务稳定性， zookeeper
促销时间如何保证数据正确及时 =》冗余策略
数据更新模型 =》拉模型

kafka消息队列多个且分快慢，按照业务轻重缓急处理

后续都是软工的理论
####应对高并发
* 关于缓存的使用
通过分析日志中，对于请求中超过100ms的请求进行缓存并保持3分钟
* 横向扩展
* 能用加机器解决的问题就加机器
* 应用挂了就回滚并且是自动回滚，由一个系统框架来分析日志，找出故障点的插件，将该插件回滚到前一版本
* 统一日志收集分析：flume

####排序
针对用户展示
* 用户行为模型
利用点击中的“分类”信息来辅助意图探测，进而排除掉小概率用户需要的东西排到前面了
* 排序模型
机器学习来综合销量、点击、活动、折扣、图片、查询

###游戏开发设计

####架构
1. p2p
2. cs
校验数据或者是运算逻辑

###同步数据
帧同步：像素级别同步

1. 逻辑在客户端
2. 同步输入、同步指令
3. 要求所有客户端都执行完一个指令再执行下一个

状态同步
1. 固定逻辑或者管卡在客户端、服务端验证
2. 同步实体状态
3. 按照游戏实体进行管理
4. 





* 
* 	  
* 

